<!DOCTYPE html>
<html>
<head><link rel="stylesheet" href="styles.css"></head>
<body>
<div class="container">
<div class="card">
<img src="logo.svg" height="50">
<input id="business" placeholder="Business Name">
<input id="color" placeholder="Brand Color (#hex)">
<input id="welcome" placeholder="Welcome Message">
<select id="tone">
  <option>professional</option>
  <option>friendly</option>
</select>
<button onclick="create()">Create Chatbox</button>
<pre id="code"></pre>
</div>
</div>
<script>
async function create() {
  try {
    const res = await fetch("/create-bot", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        business: document.getElementById("business").value,
        color: document.getElementById("color").value,
        welcome: document.getElementById("welcome").value,
        tone: document.getElementById("tone").value
      })
    });

    if (!res.ok) {
      throw new Error(Server error: ${res.status});
    }

    const data = await res.json();
    document.getElementById("code").innerText =
      <script src="https://nudella-ai-production.up.railway.app/chatbox.js" data-token="${data.token}"></script>;

  } catch (err) {
    console.error("Error creating chatbox:", err);
    alert("Failed to create chatbox. Check console for details.");
  }
}
</script>
</body>
</html>
